!function(a){var b={margin:{top:10,right:10,bottom:30,left:50},aspectRatio:16/9,x:{ticks:5},y:{ticks:10},showLabels:!1,pointRadius:5,width:600};this.scatterChart=function(c,d,e){var f,g,h,i,j=a(!0,{},b,d),k=j.width,l=Math.ceil(k/j.aspectRatio),m=j.innerHeight=l-j.margin.top-j.margin.bottom,n=j.innerWidth=k-j.margin.left-j.margin.right,o=c.select("g"),p=o.select(".data"),q=d3.transition().duration(1e3).ease(d3.easeLinear),r=function(a){var b,c,d,e=function(a,b){return a-b};return b=a.map(function(a){return j.x.getValue(a)}).sort(e),c=a.map(function(a){return j.y.getValue(a)}).sort(e),d=Math.floor(.05*a.length),{x:{min:b[d],max:b[b.length-d]},y:{min:c[d],max:c[c.length-d]}}},s=function(){var a,b,c,i,k,l=this.settings,s=l.filterData&&"function"==typeof l.filterData?l.filterData.call(l,e):e,t=l.displayOnly&&"function"==typeof l.displayOnly?l.displayOnly.call(l,s):null,u=o.select(".x.axis"),v=o.select(".y.axis"),w=1+l.pointRadius/m,x=function(a,b){var c="point point"+(b+1);return l.z&&l.z.getClass&&"function"==typeof l.z.getClass&&(c+=" "+l.z.getClass.call(l,a)),t&&-1===t.indexOf(a)||(c+=" visible"),c},y=function(a,b){var c="label label"+(b+1);return t&&-1===t.indexOf(a)||(c+=" visible"),c},z=function(a){if(l.z&&l.z.getId&&"function"==typeof l.z.getId)return l.z.getId(a)},A=function(a){return f(l.x.getValue.call(this,a))},B=function(a){return g(l.y.getValue.call(this,a))},C=function(a,b,c){var d=c[b].getBBox(),e=A(a)+l.pointRadius;return e+d.width>n&&(e-=d.width+2*l.pointRadius),e},D=function(a){var b=B(a)-l.pointRadius;return b<0&&(b=2*+l.pointRadius),b};l.filterOutliars?(c=r(s),a=[c.x.min,c.x.max],b=[c.y.min,c.y.max]):(a=d3.extent(t||s,l.x.getValue.bind(l)),b=d3.extent(t||s,l.y.getValue.bind(l))),a[0]-=w,b[0]-=w,a[1]+=w,b[1]+=w,f=h.x=d3.scaleLinear().range([0,n]),g=h.y=d3.scaleLinear().range([m,0]),f.domain(a),g.domain(b),p.empty()&&(p=o.append("g").attr("class","data")),i=p.selectAll(".point").data(s,l.z.getId.bind(l)),i.enter().append("circle").attr("r",l.pointRadius).attr("id",z).attr("class",x).attr("cx",A).attr("cy",B),i.transition(q).attr("class",x).attr("cx",A).attr("cy",B),i.exit().remove(),k=p.selectAll(".label"),l.showLabels?(k.data(s).enter().append("text").text(l.z.getText.bind(l)).attr("aria-hidden","true").attr("class",y).attr("fill","#000").attr("x",C).attr("y",D),k.transition(q).text(l.z.getText.bind(l)).attr("class",y).attr("x",C).attr("y",D),k.exit().remove()):k.remove(),u.empty()&&(u=o.append("g").attr("class","x axis").attr("aria-hidden","true").attr("transform","translate(0,"+m+")"),u.append("text").attr("class","chart-label").attr("fill","#000").attr("x",n).attr("dy","-0.5em").attr("text-anchor","end").text(d.x.label)),u.call(d3.axisBottom(f).ticks(j.x.ticks).tickFormat(l.x.getTickText?l.x.getTickText.bind(l):null)),v.empty()&&(v=o.append("g").attr("class","y axis").attr("aria-hidden","true"),v.append("text").attr("class","chart-label").attr("fill","#000").attr("y","0").attr("transform","rotate(-90)").attr("dy","1.5em").attr("text-anchor","end").text(d.y.label)),v.call(d3.axisLeft(g).ticks(j.y.ticks).tickFormat(l.y.getTickText?l.y.getTickText.bind(l):null))},t=function(){var a,b,f,g,h,i=this.settings,j=i.filterData&&"function"==typeof i.filterData?i.filterData(e,"table"):e,k=c.select(c.classed("svg-shimmed")?function(){return this.parentNode.parentNode}:function(){return this.parentNode}),l=k.select("details");l.empty()&&(l=k.append("details").attr("class","chart-data-table"),l.append("summary").attr("id","chrt-dt-tbl").text(d.datatable.title||"Data"),a=l.append("table").attr("class","table").attr("aria-labelledby","chrt-dt-tbl"),b=a.append("thead").append("tr"),f=a.append("tbody"),b.append("th").text(d.z.label),b.append("th").text(d.x.label),b.append("th").text(d.y.label),g=f.selectAll("tr").data(j),h=g.enter().append("tr"),h.append("th").text(d.z.getText.bind(i)),h.append("td").text((d.x.getText||d.x.getValue).bind(i)),h.append("td").text((d.y.getText||d.y.getValue).bind(i)),($||wb)&&$(".chart-data-table summary").trigger("wb-init.wb-details"))},u=function(){p.remove()};return h={settings:j,clear:u,svg:c},c.attr("height",l+"px").attr("viewBox","0 0 "+k+" "+l).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",j.altText),c.node().msContentZoomFactor&&c.attr("height",l),o.empty()&&(o=c.append("g").attr("transform","translate("+j.margin.left+","+j.margin.top+")")),i=function(){s.apply(h),!1!==j.datatable&&(t.apply(h),d3.stcExt.addIEShim(c,l,k))},j.data?i():d3.json(j.url,function(a,b){e=b,i()}),h}}(jQuery.extend);
//# sourceMappingURL=scatter.min.js.map