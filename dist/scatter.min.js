!function(a){var b={margin:{top:10,right:10,bottom:30,left:50},aspectRatio:16/9,x:{ticks:5},y:{ticks:10},showLabels:!1,pointRadius:5,width:600};this.scatterChart=function(c,d){var e,f,g,h,i=a(!0,{},b,d),j=i.width,k=Math.ceil(j/i.aspectRatio),l=i.innerHeight=k-i.margin.top-i.margin.bottom,m=i.innerWidth=j-i.margin.left-i.margin.right,n=c.select("g"),o=d3.transition().duration(1e3).ease(d3.easeLinear),p=function(a){var b,c,d,e=function(a,b){return a-b};return b=a.map(function(a){return i.x.getValue(a)}).sort(e),c=a.map(function(a){return i.y.getValue(a)}).sort(e),d=Math.floor(.05*a.length),{x:{min:b[d],max:b[b.length-d]},y:{min:c[d],max:c[c.length-d]}}},q=function(){var a,b,c,h,j,k=this.settings,q=k.filterData&&"function"==typeof k.filterData?k.filterData.call(k,k.data):k.data,r=n.select(".x.axis"),s=n.select(".y.axis"),t=n.select(".data"),u=1+k.pointRadius/l,v=k.displayOnly&&"function"==typeof k.displayOnly?k.displayOnly.call(k,q):null,w=function(a,b){var c="point point"+(b+1);return k.z&&k.z.getClass&&"function"==typeof k.z.getClass&&(c+=" "+k.z.getClass.call(k,a)),v&&-1===v.indexOf(a)||(c+=" visible"),c},x=function(a,b){var c="label label"+(b+1);return v&&-1===v.indexOf(a)||(c+=" visible"),c},y=function(a){if(k.z&&k.z.getId&&"function"==typeof k.z.getId)return k.z.getId(a)},z=function(a){return e(k.x.getValue.call(this,a))},A=function(a){return f(k.y.getValue.call(this,a))},B=function(a,b,c){var d=c[b].getBBox(),e=z(a)+k.pointRadius;return e+d.width>m&&(e-=d.width+2*k.pointRadius),e},C=function(a){var b=A(a)-k.pointRadius;return b<0&&(b=2*+k.pointRadius),b};k.filterOutliars?(c=p(q),a=[c.x.min,c.x.max],b=[c.y.min,c.y.max]):(a=d3.extent(v||q,k.x.getValue.bind(k)),b=d3.extent(v||q,k.y.getValue.bind(k))),a[0]-=u,b[0]-=u,a[1]+=u,b[1]+=u,e=g.x=d3.scaleLinear().range([0,m]),f=g.y=d3.scaleLinear().range([l,0]),e.domain(a),f.domain(b),t.empty()&&(t=n.append("g").attr("class","data")),h=t.selectAll(".point").data(q,k.z.getId.bind(k)),h.enter().append("circle").attr("r",k.pointRadius).attr("id",y).attr("class",w).attr("cx",z).attr("cy",A),h.transition(o).attr("class",w).attr("cx",z).attr("cy",A),h.exit().remove(),j=t.selectAll(".label"),k.showLabels?(j.data(q).enter().append("text").text(k.z.getText.bind(k)).attr("aria-hidden","true").attr("class",x).attr("fill","#000").attr("x",B).attr("y",C),j.transition(o).text(k.z.getText.bind(k)).attr("class",x).attr("x",B).attr("y",C),j.exit().remove()):j.remove(),r.empty()&&(r=n.append("g").attr("class","x axis").attr("aria-hidden","true").attr("transform","translate(0,"+l+")"),r.append("text").attr("class","chart-label").attr("fill","#000").attr("x",m).attr("dy","-0.5em").attr("text-anchor","end").text(d.x.label)),r.call(d3.axisBottom(e).ticks(i.x.ticks)),s.empty()&&(s=n.append("g").attr("class","y axis").attr("aria-hidden","true"),s.append("text").attr("class","chart-label").attr("fill","#000").attr("y","0").attr("transform","rotate(-90)").attr("dy","1.5em").attr("text-anchor","end").text(d.y.label)),s.call(d3.axisLeft(f).ticks(i.y.ticks))},r=function(){var a,b,e,f,g,h=this.settings,i=h.filterData&&"function"==typeof h.filterData?h.filterData(h.data,"table"):h.data,j=c.select(function(){return this.parentNode}),k=j.select("details");k.empty()&&(k=j.append("details").attr("class","chart-data-table"),k.append("summary").attr("id","chrt-dt-tbl").text(d.datatable.title||"Data"),a=k.append("table").attr("class","table"),b=a.append("thead").append("tr"),e=a.append("tbody"),b.append("th").text(d.z.label),b.append("th").text(d.x.label),b.append("th").text(d.y.label),f=e.selectAll("tr").data(i),g=f.enter().append("tr"),g.append("th").text(d.z.getText.bind(h)),g.append("td").text((d.x.getText||d.x.getValue).bind(h)),g.append("td").text((d.y.getText||d.y.getValue).bind(h)),$&&$(".chart-data-table summary").trigger("wb-init.wb-details"))};return g={settings:i,svg:c},c.attr("height",k+"px").attr("viewBox","0 0 "+j+" "+k).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",i.altText),c.node().msContentZoomFactor&&c.attr("height",k),n.empty()&&(n=c.append("g").attr("transform","translate("+i.margin.left+","+i.margin.top+")")),h=function(){q.apply(g),!1!==i.datatable&&(r.apply(g),d3.stcExt.addIEShim(c,k,j))},i.data?h():d3.json(i.url,function(a,b){i.data=b,h()}),g}}(jQuery.extend);
//# sourceMappingURL=scatter.min.js.map