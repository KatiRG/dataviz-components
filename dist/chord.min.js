!function(a){var b={margin:{top:2,right:2,bottom:2,left:2},arcsWidth:20,padding:.03,aspectRatio:16/9,width:600};this.chordChart=function(c,d){var e,f,g=a(!0,{},b,d),h=g.width,i=Math.ceil(h/g.aspectRatio),j=g.innerHeight=i-g.margin.top-g.margin.bottom,k=g.innerWidth=h-g.margin.left-g.margin.right,l=c.select("g"),m=l.select(".data"),n=function(){var a,b,d,e,f=this.settings,g=f.filterData&&"function"==typeof f.filterData?f.filterData.call(f,f.data):f.data,h=Math.min(j,k)/2,i=h-f.arcsWidth,n=f.arcs&&f.arcs.getId?f.arcs.getId.bind(f):null,o=f.arcs&&f.arcs.getClass?f.arcs.getClass.bind(f):null,p=f.arcs&&f.arcs.getText?f.arcs.getText.bind(f):null,q=f.ribbons&&f.ribbons.getId?f.ribbons.getId.bind(f):null,r=f.ribbons?f.ribbons.getClass.bind(f):null,s=function(a){var b,c,d,e,f=d3.select(this),g=f.text();return""!==g?(b=f.select("textPath").remove(),f.text(g),c=this.getSubStringLength(0,g.length),f.text(null).insert(function(){return b.node()}),d=(a.endAngle-a.startAngle)/(2*Math.PI),e=2*d*Math.PI*i/2,c<e):null},t=function(){return!0===s.apply(this,arguments)?"1":"0"},u=d3.chord().padAngle(f.padding),v=d3.arc().innerRadius(i).outerRadius(h),w=d3.ribbon().radius(i);f.startAngle&&(v.startAngle(f.startAngle.bind(f)),w.startAngle(f.startAngle.bind(f))),f.endAngle&&(v.endAngle(f.endAngle.bind(f)),w.endAngle(f.endAngle.bind(f))),m.empty()&&(m=l.append("g").attr("class","data").attr("transform","translate("+k/2+","+j/2+")")),m.datum(function(a){var b,c,d,e,f=u(a.matrix);for(b=0;b<f.groups.length;b++)c=f.groups[b],c.index=a.indexes[c.index];for(d=0;d<f.length;d++)e=f[d],e.source.index=a.indexes[e.source.index],e.source.subIndex=a.indexes[e.source.subIndex],e.target.index=a.indexes[e.target.index],e.target.subIndex=a.indexes[e.target.subIndex];return f}(f.getMatrix.call(f,g))),a=m.select(".arcs"),a.empty()&&(a=m.append("g").attr("class","arcs")),d=a.selectAll("g").data(function(a){return a.groups},n),b=m.select(".ribbons"),b.empty()&&(b=m.append("g").attr("class","ribbons")),e=b.selectAll("g").data(function(a){return a},q),d.enter().append("g").attr("class",o).attr("id",n).each(function(a,b){var d,e=d3.select(this),f=function(){return c.attr("id")+"arc"+b};e.append("path").attr("d",v).attr("id",f),d=e.append("text").attr("dy",15).attr("dx",5).attr("aria-hidden","true"),d.append("textPath").attr("xlink:href",function(){return"#"+f.apply(this,arguments)}).text(p),d.style("opacity",t)}),d.attr("class",o).each(function(){var a=d3.select(this);a.select("text").style("opacity",t),a.select("path").attr("d",v)}),d.exit().remove(),e.enter().append("g").attr("id",q).attr("class",r).each(function(){d3.select(this).append("path").attr("d",w)}),e.attr("class",r).each(function(){d3.select(this).select("path").attr("d",w)}),e.exit().remove()};return e={settings:g,svg:c},c.attr("viewBox","0 0 "+h+" "+i).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",g.altText),l.empty()&&(l=c.append("g").attr("transform","translate("+g.margin.left+","+g.margin.top+")")),f=function(){n.apply(e),!1!==g.datatable&&d3.stcExt.addIEShim(c,i,h)},g.data?f():d3.json(g.url,function(a,b){g.data=b,f()}),e}}(jQuery.extend,jQuery);
//# sourceMappingURL=chord.min.js.map